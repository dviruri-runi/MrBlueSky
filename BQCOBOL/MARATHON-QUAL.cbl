       IDENTIFICATION DIVISION.
       PROGRAM-ID. MARATHON-QUALIFY-REST IS INITIAL.

       DATA DIVISION.

       WORKING-STORAGE SECTION.

       01 I                             PIC 99.
       01 WS-QUALIFY-FLAG              PIC X VALUE 'N'.
           88 ATHLETE-QUALIFIED        VALUE 'Y'.
           88 ATHLETE-NOT-QUALIFIED    VALUE 'N'.

       01 WS-CALCULATED-TIME           PIC 9(5)V99 VALUE 0.
       01 WS-QUALIFYING-TIME-MINS      PIC 9(5)V99 VALUE 0.
       01 WS-SECONDS-FRACTION          PIC 9(3)V99 VALUE 0.

       01 MQ-AGE-LOW       OCCURS 11 TIMES PIC 999 VALUE ZEROS.
       01 MQ-AGE-HIGH      OCCURS 11 TIMES PIC 999 VALUE ZEROS.
       01 MQ-MALE-TIME     OCCURS 11 TIMES PIC 9(3)V99 VALUE ZEROS.
       01 MQ-FEMALE-TIME   OCCURS 11 TIMES PIC 9(3)V99 VALUE ZEROS.

       LINKAGE SECTION.

       01 INPUT-REQUEST.
           05 AGE-IN        PIC 999.
           05 GENDER-IN     PIC X.
           05 HOURS-IN      PIC 99.
           05 MINUTES-IN    PIC 99.
           05 SECONDS-IN    PIC 99.

       01 OUTPUT-RESPONSE.
           05 RESULT-CODE-OUT     PIC X(2).
           05 RESULT-MESSAGE-OUT PIC X(50).
           05 TIME-MINS-OUT      PIC 9(5)V99.
           05 QUAL-TIME-OUT      PIC 9(5)V99.
           05 QUALIFY-FLAG-OUT   PIC X.

       PROCEDURE DIVISION USING INPUT-REQUEST OUTPUT-RESPONSE.

       MAIN-REST-PROCEDURE.

           PERFORM POPULATE-STANDARDS

        COMPUTE WS-SECONDS-FRACTION = FUNCTION NUMVAL(SECONDS-IN) / 60.0
        COMPUTE WS-CALCULATED-TIME =
            (HOURS-IN * 60) + MINUTES-IN + WS-SECONDS-FRACTION

           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 11
               IF AGE-IN >= MQ-AGE-LOW(I)
                  AND AGE-IN <= MQ-AGE-HIGH(I)
                   IF GENDER-IN = 'M'
                       MOVE MQ-MALE-TIME(I) TO WS-QUALIFYING-TIME-MINS
                   ELSE
                       MOVE MQ-FEMALE-TIME(I) TO WS-QUALIFYING-TIME-MINS
                   END-IF
                   EXIT PERFORM
               END-IF
           END-PERFORM

           IF WS-QUALIFYING-TIME-MINS = 0
               MOVE '99' TO RESULT-CODE-OUT
               MOVE 'NO MATCHINGTIME' TO RESULT-MESSAGE-OUT
               MOVE ZERO TO TIME-MINS-OUT
               MOVE ZERO TO QUAL-TIME-OUT
               MOVE WS-QUALIFY-FLAG TO QUALIFY-FLAG-OUT
               GOBACK
           END-IF

           IF WS-CALCULATED-TIME <= WS-QUALIFYING-TIME-MINS
               SET ATHLETE-QUALIFIED TO TRUE
           ELSE
               SET ATHLETE-NOT-QUALIFIED TO TRUE
           END-IF

           IF ATHLETE-QUALIFIED
               MOVE '00' TO RESULT-CODE-OUT
               MOVE 'QUALIFIED' TO RESULT-MESSAGE-OUT
           ELSE
               MOVE '01' TO RESULT-CODE-OUT
               MOVE 'NOT QUALIFIED' TO RESULT-MESSAGE-OUT
           END-IF

           MOVE WS-CALCULATED-TIME TO TIME-MINS-OUT
           MOVE WS-QUALIFYING-TIME-MINS TO QUAL-TIME-OUT
           MOVE WS-QUALIFY-FLAG TO QUALIFY-FLAG-OUT

           GOBACK.

       POPULATE-STANDARDS.

       MOVE  18 TO MQ-AGE-LOW(1)     MOVE  34 TO MQ-AGE-HIGH(1)
       MOVE 185.00 TO MQ-MALE-TIME(1) MOVE 210.00 TO MQ-FEMALE-TIME(1)   

       MOVE  35 TO MQ-AGE-LOW(2)     MOVE  39 TO MQ-AGE-HIGH(2)
       MOVE 190.00 TO MQ-MALE-TIME(2) MOVE 215.00 TO MQ-FEMALE-TIME(2) 

       MOVE  40 TO MQ-AGE-LOW(3)     MOVE  44 TO MQ-AGE-HIGH(3)
       MOVE 195.00 TO MQ-MALE-TIME(3) MOVE 220.00 TO MQ-FEMALE-TIME(3)  

       MOVE  45 TO MQ-AGE-LOW(4)     MOVE  49 TO MQ-AGE-HIGH(4)
       MOVE 200.00 TO MQ-MALE-TIME(4) MOVE 230.00 TO MQ-FEMALE-TIME(4)  

       MOVE  50 TO MQ-AGE-LOW(5)     MOVE  54 TO MQ-AGE-HIGH(5)
       MOVE 205.00 TO MQ-MALE-TIME(5) MOVE 235.00 TO MQ-FEMALE-TIME(5)  

       MOVE  55 TO MQ-AGE-LOW(6)     MOVE  59 TO MQ-AGE-HIGH(6)
       MOVE 210.00 TO MQ-MALE-TIME(6) MOVE 245.00 TO MQ-FEMALE-TIME(6)  

       MOVE  60 TO MQ-AGE-LOW(7)     MOVE  64 TO MQ-AGE-HIGH(7)
       MOVE 215.00 TO MQ-MALE-TIME(7) MOVE 255.00 TO MQ-FEMALE-TIME(7)  

       MOVE  65 TO MQ-AGE-LOW(8)     MOVE  69 TO MQ-AGE-HIGH(8)
       MOVE 220.00 TO MQ-MALE-TIME(8) MOVE 260.00 TO MQ-FEMALE-TIME(8)  

       MOVE  70 TO MQ-AGE-LOW(9)     MOVE  74 TO MQ-AGE-HIGH(9)
       MOVE 225.00 TO MQ-MALE-TIME(9) MOVE 270.00 TO MQ-FEMALE-TIME(9)  

       MOVE  75 TO MQ-AGE-LOW(10)    MOVE  79 TO MQ-AGE-HIGH(10)
       MOVE 230.00 TO MQ-MALE-TIME(10) MOVE 280.00 TO MQ-FEMALE-TIME(10)

       MOVE  80 TO MQ-AGE-LOW(11)    MOVE 120 TO MQ-AGE-HIGH(11)
       MOVE 235.00 TO MQ-MALE-TIME(11) MOVE 290.00 TO MQ-FEMALE-TIME(11)
